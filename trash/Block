#!/usr/bin/env bash
# Generated by Trashtalk Compiler (jq) - DO NOT EDIT
# Source: Block.trash
# Generated: 2025-12-22T03:22:57

__Block__superclass="Object"
__Block__instanceVars="params code captured"
__Block__classInstanceVars=""
__Block__traits=""

__Block__class__params_code_captured_() {
  local p="$1"
  local c="$2"
  local cap="$3"
  local id
  id=$(_generate_instance_id Block)
  _create_instance Block "$id"
  @ "$id" setParams "$p"
  @ "$id" setCode "$c"
  @ "$id" setCaptured "$cap"
  echo "$id"
}

__Block__value() {
    local code params captured
    code=$(@ "$_RECEIVER" getCode)
    params=$(@ "$_RECEIVER" getParams)
    captured=$(@ "$_RECEIVER" getCaptured)

    # Restore captured variables
    local _saved_RECEIVER="$_RECEIVER"
    if [[ -n "$captured" && "$captured" != "null" ]]; then
        local cap_receiver
        cap_receiver=$(echo "$captured" | jq -r '._RECEIVER // empty')
        [[ -n "$cap_receiver" ]] && _RECEIVER="$cap_receiver"
    fi

    # Execute the code
    eval "$code"
    local result=$?

    # Restore context
    _RECEIVER="$_saved_RECEIVER"
    return $result
}

__Block__valueWith_() {
  local arg="$1"
    local code params captured arg1="$1"
    code=$(@ "$_RECEIVER" getCode)
    params=$(@ "$_RECEIVER" getParams)
    captured=$(@ "$_RECEIVER" getCaptured)

    # Get parameter name
    local param1
    param1=$(echo "$params" | jq -r '.[0] // empty')

    # Restore captured variables
    local _saved_RECEIVER="$_RECEIVER"
    if [[ -n "$captured" && "$captured" != "null" ]]; then
        local cap_receiver
        cap_receiver=$(echo "$captured" | jq -r '._RECEIVER // empty')
        [[ -n "$cap_receiver" ]] && _RECEIVER="$cap_receiver"
    fi

    # Bind parameter and execute
    if [[ -n "$param1" ]]; then
        eval "local $param1=\" $arg1 \"; $code"
        else
        eval "$code"
    fi
    local result=$?

    # Restore context
    _RECEIVER="$_saved_RECEIVER"
    return $result
}

__Block__valueWith_and_() {
  local a="$1"
  local b="$2"
    local code params captured arg1="$1" arg2="$2"
    code=$(@ "$_RECEIVER" getCode)
    params=$(@ "$_RECEIVER" getParams)
    captured=$(@ "$_RECEIVER" getCaptured)

    # Get parameter names
    local param1 param2
    param1=$(echo "$params" | jq -r '.[0] // empty')
    param2=$(echo "$params" | jq -r '.[1] // empty')

    # Restore captured variables
    local _saved_RECEIVER="$_RECEIVER"
    if [[ -n "$captured" && "$captured" != "null" ]]; then
        local cap_receiver
        cap_receiver=$(echo "$captured" | jq -r '._RECEIVER // empty')
        [[ -n "$cap_receiver" ]] && _RECEIVER="$cap_receiver"
    fi

    # Bind parameters and execute
    local bindings=""
    [[ -n "$param1" ]] && bindings="local $param1=\" $arg1 \"; "
    [[ -n "$param2" ]] && bindings="${bindings}local $param2=\" $arg2 \"; "
    eval "${bindings}$code"
    local result=$?

    # Restore context
    _RECEIVER="$_saved_RECEIVER"
    return $result
}

__Block__numArgs() {
  local p
  p=$(@ $_RECEIVER getParams).
  echo $(echo "$p" | jq 'length')
}
