#!/usr/bin/env bash
# Generated by Trashtalk Compiler (jq) - DO NOT EDIT
# Source: Json.trash
# Generated: 2026-01-14T21:23:33

__Json__superclass="Object"
__Json__instanceVars="data: type:"
__Json__classInstanceVars=""
__Json__traits=""
__Json__sourceHash="137017606803a430038751aec7ed1a1d79cfb7c5de81fab0af058cd1d884b8c2"

__Json__source() {
  cat <<'__TRASHTALK_SOURCE_EOF__'
# Json - Builder for JSON construction and parsing
# Provides fluent API for building JSON objects and arrays without bash tools like jo
#
# Usage:
#   # Build an object
#   json := @ Json object
#     at: 'name' put: 'Alice'
#     at: 'age' put: '30'
#     build.
#   # => {"name":"Alice","age":"30"}
#
#   # Build with nested objects
#   json := @ Json object
#     at: 'session_id' putJson: (@ Json object at: 'id' put: sid; build)
#     at: 'type' put: 'WIDGET_LIST'
#     build.
#   # => {"session_id":{"id":"abc123"},"type":"WIDGET_LIST"}
#
#   # Build an array
#   json := @ Json array
#     push: 'first'
#     push: 'second'
#     build.
#   # => ["first","second"]
#
#   # Parse JSON and extract values
#   value := jsonString jsonPath: 'session_id.id'.

Json subclass: Object
  instanceVars: data:'' type:''

  # ============================================================================
  # Factory Methods
  # ============================================================================

  # Create a new JSON object builder
  classMethod: object [
    | instance |
    instance := @ Json new.
    @ instance _setType: 'object'.
    @ instance _setData: '{}'.
    ^ instance
  ]

  # Create a new JSON array builder
  classMethod: array [
    | instance |
    instance := @ Json new.
    @ instance _setType: 'array'.
    @ instance _setData: '[]'.
    ^ instance
  ]

  # ============================================================================
  # Object Building Methods (return self for chaining)
  # ============================================================================

  # Set a string value at key
  # Usage: @ builder at: 'name' put: 'Alice'
  method: at: key put: value [
    data := data objectAt: key put: value.
    ^ self
  ]

  # Set a raw JSON value at key (for nested objects/arrays)
  # Usage: @ builder at: 'nested' putJson: '{"a":1}'
  method: at: key putJson: jsonValue [
    data := data objectAt: key putJson: jsonValue.
    ^ self
  ]

  # Set a numeric value at key
  # Note: Numbers are passed as strings and inserted as raw JSON
  # Usage: @ builder at: 'count' putNumber: '42'
  method: at: key putNumber: numValue [
    data := data objectAt: key putJson: numValue.
    ^ self
  ]

  # Set a boolean value at key
  # Usage: @ builder at: 'enabled' putBool: 'true'
  method: at: key putBool: boolValue [
    data := data objectAt: key putJson: boolValue.
    ^ self
  ]

  # ============================================================================
  # Array Building Methods (return self for chaining)
  # ============================================================================

  # Push a string value onto the array
  # Usage: @ builder push: 'item'
  method: push: value [
    data := data arrayPush: value.
    ^ self
  ]

  # Push a raw JSON value onto the array (for nested objects/arrays)
  # Usage: @ builder pushJson: '{"nested":true}'
  method: pushJson: jsonValue [
    data := data arrayPushJson: jsonValue.
    ^ self
  ]

  # Push a numeric value onto the array
  # Usage: @ builder pushNumber: '42'
  method: pushNumber: numValue [
    data := data arrayPushJson: numValue.
    ^ self
  ]

  # Push a boolean value onto the array
  # Usage: @ builder pushBool: 'true'
  method: pushBool: boolValue [
    data := data arrayPushJson: boolValue.
    ^ self
  ]

  # ============================================================================
  # Finalization
  # ============================================================================

  # Return the built JSON string
  method: build [
    ^ data
  ]

  # Alias for build (more Smalltalk-like)
  method: asString [
    ^ data
  ]

  # ============================================================================
  # Convenience Class Methods for Common Patterns
  # ============================================================================

  # Create a simple {"key": "value"} object
  classMethod: key: k value: v [
    | builder _ |
    builder := @ Json object.
    _ := @ builder at: k put: v.
    ^ @ builder build
  ]

  # Create a session_id wrapper: {"session_id": {"id": "sid"}}
  classMethod: sessionId: sid [
    | innerBuilder outerBuilder inner _ |
    innerBuilder := @ Json object.
    _ := @ innerBuilder at: 'id' put: sid.
    inner := @ innerBuilder build.
    outerBuilder := @ Json object.
    _ := @ outerBuilder at: 'session_id' putJson: inner.
    ^ @ outerBuilder build
  ]

  # Create a widget_id wrapper: {"widget_id": {"id": "wid"}}
  classMethod: widgetId: wid [
    | innerBuilder outerBuilder inner _ |
    innerBuilder := @ Json object.
    _ := @ innerBuilder at: 'id' put: wid.
    inner := @ innerBuilder build.
    outerBuilder := @ Json object.
    _ := @ outerBuilder at: 'widget_id' putJson: inner.
    ^ @ outerBuilder build
  ]

  # Create combined session + widget wrapper
  classMethod: sessionId: sid widgetId: wid [
    | sidBuilder widBuilder builder sidJson widJson _ |
    sidBuilder := @ Json object.
    _ := @ sidBuilder at: 'id' put: sid.
    sidJson := @ sidBuilder build.
    widBuilder := @ Json object.
    _ := @ widBuilder at: 'id' put: wid.
    widJson := @ widBuilder build.
    builder := @ Json object.
    _ := @ builder at: 'session_id' putJson: sidJson.
    _ := @ builder at: 'widget_id' putJson: widJson.
    ^ @ builder build
  ]

  # ============================================================================
  # Private Setters
  # ============================================================================

  method: _setType: t [ type := t ]
  method: _setData: d [ data := d ]
  method: _getType [ ^ type ]
  method: _getData [ ^ data ]
__TRASHTALK_SOURCE_EOF__
}

__Json__data() {
  echo "$(_ivar data)"; return
}

__Json__data_() {
  _ivar_set data "$1"
}

__Json__getData() {
  echo "$(_ivar data)"; return
}

__Json__setData_() {
  _ivar_set data "$1"
}
__Json__type() {
  echo "$(_ivar type)"; return
}

__Json__type_() {
  _ivar_set type "$1"
}

__Json__getType() {
  echo "$(_ivar type)"; return
}

__Json__setType_() {
  _ivar_set type "$1"
}

__Json__class__object() {
  local instance
  instance="$(@ Json new)"
  @ "$instance" : 'object' setType: null
  @ "$instance" : '{}' setData: null
  echo "$instance"; return
}

__Json__class__array() {
  local instance
  instance="$(@ Json new)"
  @ "$instance" : 'array' setType: null
  @ "$instance" : '[]' setData: null
  echo "$instance"; return
}

__Json__at_put_() {
  local key="$1"
  local value="$2"
  _ivar_set data "$(echo "$(_ivar data)" | jq -c --arg k "$key" --arg v "$value" '.[$k] = $v')"
  echo ""$_RECEIVER""; return
}

__Json__at_putJson_() {
  local key="$1"
  local jsonValue="$2"
  _ivar_set data "$(echo "$(_ivar data)" | jq -c --arg k "$key" --argjson v "$jsonValue" '.[$k] = $v')"
  echo ""$_RECEIVER""; return
}

__Json__at_putNumber_() {
  local key="$1"
  local numValue="$2"
  _ivar_set data "$(echo "$(_ivar data)" | jq -c --arg k "$key" --argjson v "$numValue" '.[$k] = $v')"
  echo ""$_RECEIVER""; return
}

__Json__at_putBool_() {
  local key="$1"
  local boolValue="$2"
  _ivar_set data "$(echo "$(_ivar data)" | jq -c --arg k "$key" --argjson v "$boolValue" '.[$k] = $v')"
  echo ""$_RECEIVER""; return
}

__Json__push_() {
  local value="$1"
  _ivar_set data "$(echo "$(_ivar data)" | jq -c --arg v "$value" '. + [$v]')"
  echo ""$_RECEIVER""; return
}

__Json__pushJson_() {
  local jsonValue="$1"
  _ivar_set data "$(echo "$(_ivar data)" | jq -c --argjson v "$jsonValue" '. + [$v]')"
  echo ""$_RECEIVER""; return
}

__Json__pushNumber_() {
  local numValue="$1"
  _ivar_set data "$(echo "$(_ivar data)" | jq -c --argjson v "$numValue" '. + [$v]')"
  echo ""$_RECEIVER""; return
}

__Json__pushBool_() {
  local boolValue="$1"
  _ivar_set data "$(echo "$(_ivar data)" | jq -c --argjson v "$boolValue" '. + [$v]')"
  echo ""$_RECEIVER""; return
}

__Json__build() {
  echo "$(_ivar data)"; return
}

__Json__asString() {
  echo "$(_ivar data)"; return
}

__Json__class__key_value_() {
  local k="$1"
  local v="$2"
  local builder _
  builder="$(@ Json object)"
  _="$(@ "$builder" at: "$k" put: "$v")"
  @ "$builder" build; return
}

__Json__class__sessionId_() {
  local sid="$1"
  local innerBuilder outerBuilder inner _
  innerBuilder="$(@ Json object)"
  _="$(@ "$innerBuilder" at: 'id' put: "$sid")"
  inner="$(@ "$innerBuilder" build)"
  outerBuilder="$(@ Json object)"
  _="$(@ "$outerBuilder" at: 'session_id' putJson: "$inner")"
  @ "$outerBuilder" build; return
}

__Json__class__widgetId_() {
  local wid="$1"
  local innerBuilder outerBuilder inner _
  innerBuilder="$(@ Json object)"
  _="$(@ "$innerBuilder" at: 'id' put: "$wid")"
  inner="$(@ "$innerBuilder" build)"
  outerBuilder="$(@ Json object)"
  _="$(@ "$outerBuilder" at: 'widget_id' putJson: "$inner")"
  @ "$outerBuilder" build; return
}

__Json__class__sessionId_widgetId_() {
  local sid="$1"
  local wid="$2"
  local sidBuilder widBuilder builder sidJson widJson _
  sidBuilder="$(@ Json object)"
  _="$(@ "$sidBuilder" at: 'id' put: "$sid")"
  sidJson="$(@ "$sidBuilder" build)"
  widBuilder="$(@ Json object)"
  _="$(@ "$widBuilder" at: 'id' put: "$wid")"
  widJson="$(@ "$widBuilder" build)"
  builder="$(@ Json object)"
  _="$(@ "$builder" at: 'session_id' putJson: "$sidJson")"
  _="$(@ "$builder" at: 'widget_id' putJson: "$widJson")"
  @ "$builder" build; return
}

__Json___setType_() {
  local t="$1"
  _ivar_set type "$t"
}

__Json___setData_() {
  local d="$1"
  _ivar_set data "$d"
}

__Json___getType() {
  echo "$(_ivar type)"; return
}

__Json___getData() {
  echo "$(_ivar data)"; return
}
