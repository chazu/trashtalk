#!/usr/bin/env bash
# Generated by Trashtalk Compiler (jq) - DO NOT EDIT
# Source: Procyon.trash
# Generated: 2026-01-05T02:17:45

__Tools__Procyon__superclass="Tool"
__Tools__Procyon__instanceVars=""
__Tools__Procyon__classInstanceVars=""
__Tools__Procyon__traits=""
__Tools__Procyon__sourceHash="8ae9930509b370270a3ae15f1fabb878fb354fe75013656d1ae46f67b0c65f4b"
__Tools__Procyon__package="Tools"
__Tools__Procyon__qualifiedName="Tools::Procyon"

__Tools__Procyon__source() {
  cat <<'__TRASHTALK_SOURCE_EOF__'
# Tools::Procyon - Wrapper for the Procyon Go compiler
# Installs via `go install` from GitHub
#
# Procyon compiles Trashtalk AST JSON to native Go binaries for performance.
# It supports a subset of Trashtalk features, falling back to Bash for unsupported constructs.
#
# Usage:
#   @ Tools::Procyon ensure              # Install if needed
#   @ Tools::Procyon version             # Show version
#   @ Tools::Procyon compile: input.json # Compile AST JSON to Go
#
package: Tools

Procyon subclass: Tool

  classMethod: name [
    ^ "procyon"
  ]

  classMethod: installCommand [
    ^ "go install github.com/chazu/procyon/cmd/procyon@latest"
  ]

  # Override version to use procyon's --version flag
  rawClassMethod: version [
    local tool_path
    tool_path=$(command -v procyon 2>/dev/null)
    if [[ -z "$tool_path" ]]; then
      echo "not installed"
      return 1
    fi
    "$tool_path" --version 2>/dev/null || echo "unknown"
  ]

  # Compile AST JSON to Go code (outputs to stdout)
  # Note: procyon reads from stdin, so we pipe the file
  rawClassMethod: compile: inputFile [
    local tool_path
    tool_path=$(@ "$_CLASS" path)
    if [[ -z "$tool_path" ]]; then
      _throw "ToolError" "procyon is not installed"
      return 1
    fi
    "$tool_path" < "$1"
  ]

  # Compile AST JSON and write to output file
  rawClassMethod: compile: inputFile to: outputFile [
    local tool_path
    tool_path=$(@ "$_CLASS" path)
    if [[ -z "$tool_path" ]]; then
      _throw "ToolError" "procyon is not installed"
      return 1
    fi
    "$tool_path" < "$1" > "$2"
  ]

  # Get info about what procyon supports
  rawClassMethod: info [
    local tool_path
    tool_path=$(@ "$_CLASS" path)
    if [[ -z "$tool_path" ]]; then
      _throw "ToolError" "procyon is not installed"
      return 1
    fi
    "$tool_path" --help 2>&1 | head -20
  ]
__TRASHTALK_SOURCE_EOF__
}

__Tools__Procyon__class__name() {
  echo "procyon"
}

__Tools__Procyon__class__installCommand() {
  echo "go install github.com/chazu/procyon/cmd/procyon@latest"
}

__Tools__Procyon__class__version() {
    local tool_path
    tool_path=$(command -v procyon 2>/dev/null)
    if [[ -z "$tool_path" ]]; then
        echo "not installed"
        return 1
    fi
    "$tool_path" --version 2>/dev/null || echo "unknown"
}

__Tools__Procyon__class__compile_() {
  local inputFile="$1"
    local tool_path
    tool_path=$(@ "$_CLASS" path)
    if [[ -z "$tool_path" ]]; then
        _throw "ToolError" "procyon is not installed"
        return 1
    fi
    "$tool_path" <"$1"
}

__Tools__Procyon__class__compile_to_() {
  local inputFile="$1"
  local outputFile="$2"
    local tool_path
    tool_path=$(@ "$_CLASS" path)
    if [[ -z "$tool_path" ]]; then
        _throw "ToolError" "procyon is not installed"
        return 1
    fi
    "$tool_path" <"$1" >"$2"
}

__Tools__Procyon__class__info() {
    local tool_path
    tool_path=$(@ "$_CLASS" path)
    if [[ -z "$tool_path" ]]; then
        _throw "ToolError" "procyon is not installed"
        return 1
    fi
    "$tool_path" --help 2>&1 | head -20
}
