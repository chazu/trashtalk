#!/usr/bin/env bash
# Generated by Trashtalk Compiler (jq) - DO NOT EDIT
# Source: Netcat.trash
# Generated: 2026-01-04T02:40:12

__Tools__Netcat__superclass="Tool"
__Tools__Netcat__instanceVars=""
__Tools__Netcat__classInstanceVars=""
__Tools__Netcat__traits=""
__Tools__Netcat__sourceHash="e9722d7438adab97784b172104b2a1d3e246f71c3c3ddfc5fc8b4875f50decc7"
__Tools__Netcat__package="Tools"
__Tools__Netcat__qualifiedName="Tools::Netcat"

__Tools__Netcat__source() {
  cat <<'__TRASHTALK_SOURCE_EOF__'
# Netcat tool wrapper - Network utility for TCP/UDP connections
# Provides a Trashtalk interface to the nc command
#
# Usage:
#   @ Tools::Netcat ensure                     # Verify nc is available
#   @ Tools::Netcat listen: 8080               # Listen on a port
#   @ Tools::Netcat connect: 'host' port: 80   # Connect to a host
#   @ Tools::Netcat send: 'data' to: 'host' port: 80

package: Tools

Netcat subclass: Tool

  classMethod: name [
    ^ "nc"
  ]

  classMethod: installCommand [
    ^ "nc is typically pre-installed on Unix systems"
  ]

  # Listen on a port, return received data
  # Usage: @ Tools::Netcat listen: 8080
  rawClassMethod: listen: port [
    @ Tools::Netcat ensure || return 1
    nc -l "$port"
  ]

  # Listen on a port with timeout
  # Usage: @ Tools::Netcat listen: 8080 timeout: 30
  rawClassMethod: listen: port timeout: seconds [
    @ Tools::Netcat ensure || return 1
    timeout "$seconds" nc -l "$port"
  ]

  # Listen and execute handler for each line received
  # Usage: @ Tools::Netcat listen: 8080 handler: 'echo "Got: $line"'
  rawClassMethod: listen: port handler: handler_code [
    @ Tools::Netcat ensure || return 1
    nc -l "$port" | while IFS= read -r line; do
      eval "$handler_code"
    done
  ]

  # Connect to a host and port
  # Usage: @ Tools::Netcat connect: 'example.com' port: 80
  rawClassMethod: connect: host port: port [
    @ Tools::Netcat ensure || return 1
    nc "$host" "$port"
  ]

  # Send data to a host and port
  # Usage: @ Tools::Netcat send: 'GET / HTTP/1.0\r\n\r\n' to: 'example.com' port: 80
  rawClassMethod: send: data to: host port: port [
    @ Tools::Netcat ensure || return 1
    echo -e "$data" | nc "$host" "$port"
  ]

  # Send data and get response with timeout
  # Usage: @ Tools::Netcat send: 'data' to: 'host' port: 80 timeout: 5
  rawClassMethod: send: data to: host port: port timeout: seconds [
    @ Tools::Netcat ensure || return 1
    echo -e "$data" | timeout "$seconds" nc "$host" "$port"
  ]

  # Check if a port is open on a host
  # Usage: @ Tools::Netcat isOpen: 'example.com' port: 80
  rawClassMethod: isOpen: host port: port [
    @ Tools::Netcat ensure || return 1
    nc -z "$host" "$port" 2>/dev/null && echo "true" || echo "false"
  ]

  # Scan a range of ports on a host
  # Usage: @ Tools::Netcat scan: 'localhost' ports: '80-90'
  rawClassMethod: scan: host ports: range [
    @ Tools::Netcat ensure || return 1
    nc -z "$host" $range 2>&1
  ]

  # Create a simple TCP server that echoes back input
  # Usage: @ Tools::Netcat echoServer: 8080
  rawClassMethod: echoServer: port [
    @ Tools::Netcat ensure || return 1
    echo "Starting echo server on port $port (Ctrl+C to stop)"
    while true; do
      nc -l "$port" | while IFS= read -r line; do
        echo "Echo: $line"
      done
    done
  ]
__TRASHTALK_SOURCE_EOF__
}

__Tools__Netcat__class__name() {
  echo "nc"
}

__Tools__Netcat__class__installCommand() {
  echo "nc is typically pre-installed on Unix systems"
}

__Tools__Netcat__class__listen_() {
  local port="$1"
    @ Tools :: Netcat ensure || return 1
    nc -l "$port"
}

__Tools__Netcat__class__listen_timeout_() {
  local port="$1"
  local seconds="$2"
    @ Tools :: Netcat ensure || return 1
    timeout "$seconds" nc -l "$port"
}

__Tools__Netcat__class__listen_handler_() {
  local port="$1"
  local handler_code="$2"
    @ Tools :: Netcat ensure || return 1
    nc -l "$port" | while IFS= read -r line; do
        eval "$handler_code"
    done
}

__Tools__Netcat__class__connect_port_() {
  local host="$1"
  local port="$2"
    @ Tools :: Netcat ensure || return 1
    nc "$host" "$port"
}

__Tools__Netcat__class__send_to_port_() {
  local data="$1"
  local host="$2"
  local port="$3"
    @ Tools :: Netcat ensure || return 1
    echo -e "$data" | nc "$host" "$port"
}

__Tools__Netcat__class__send_to_port_timeout_() {
  local data="$1"
  local host="$2"
  local port="$3"
  local seconds="$4"
    @ Tools :: Netcat ensure || return 1
    echo -e "$data" | timeout "$seconds" nc "$host" "$port"
}

__Tools__Netcat__class__isOpen_port_() {
  local host="$1"
  local port="$2"
    @ Tools :: Netcat ensure || return 1
    nc -z "$host" "$port" 2>/dev/null && echo "true" || echo "false"
}

__Tools__Netcat__class__scan_ports_() {
  local host="$1"
  local range="$2"
    @ Tools :: Netcat ensure || return 1
    nc -z "$host" $range 2>&1
}

__Tools__Netcat__class__echoServer_() {
  local port="$1"
    @ Tools :: Netcat ensure || return 1
    echo "Starting echo server on port $port (Ctrl+C to stop)"
    while true; do
        nc -l "$port" | while IFS= read -r line; do
            echo "Echo: $line"
        done
    done
}
