#!/usr/bin/env bash
# Generated by Trashtalk Compiler (jq) - DO NOT EDIT
# Source: Debuggable.trash (trait)
# Generated: 2026-01-12T21:21:09

__Debuggable__is_trait="1"
__Debuggable__sourceHash="2f59a9aef4f79817e872d610c6a7b749f8f252ad8cae049c2db4f047ca1d376f"

__Debuggable__source() {
  cat <<'__TRASHTALK_SOURCE_EOF__'
# Debuggable trait - provides debugging capabilities to objects
Debuggable trait

  # Output debug message (respects TRASH_DEBUG env var)
  # pragma: bashOnly (outputs to stderr, must not go through native daemon)
  method: debug: message [
    pragma: primitive
    pragma: bashOnly
    [[ "${TRASH_DEBUG:-1}" == "0" ]] && return 0
    local timestamp
    timestamp=$(date '+%Y-%m-%d %H:%M:%S')
    echo "[$timestamp] DEBUG ($_RECEIVER): $1" >&2
  ]

  # Trace a method call
  # pragma: bashOnly (calls debug: which outputs to stderr)
  method: trace: method_name args: args [
    pragma: primitive
    pragma: bashOnly
    @ "$_RECEIVER" debug: "Calling $1 with args: $2"
  ]

  # Inspect object details
  method: inspect [
    echo "Object: $_RECEIVER"
    echo "Class: $_SUPERCLASS"
    echo "Methods:"
    get_fcn_list "$(receiver_path $_RECEIVER)" | sed 's/^/  /'
  ]

  # Show the inheritance chain
  method: ancestry [
    | current_class super |
    current_class := "$_RECEIVER"
    echo "Inheritance chain for $_RECEIVER:"
    while [[ -n "$current_class" ]]; do
      echo "  $current_class"
      if [[ -f "$TRASHDIR/$current_class" ]]; then
        super := $(grep "^is_a" "$TRASHDIR/$current_class" | awk '{print $2}')
        current_class := "$super"
        if [[ "$current_class" == "Object" ]]; then
          echo "  Object"
          break
        fi
      else
        break
      fi
    done
  ]
__TRASHTALK_SOURCE_EOF__
}

declare -g __Debuggable__debug___bashOnly=1
__Debuggable__debug_() {
  local message="$1"
    [[ "${TRASH_DEBUG:-1}" == "0" ]] && return 0
    local timestamp
    timestamp=$(date '+%Y-%m-%d %H:%M:%S')
    echo "[$timestamp] DEBUG ($_RECEIVER): $1" >&2
}

declare -g __Debuggable__trace_args___bashOnly=1
__Debuggable__trace_args_() {
  local method_name="$1"
  local args="$2"
    @ "$_RECEIVER" debug: "Calling $1 with args: $2"
}

__Debuggable__inspect() {
  echo "Object: $_RECEIVER"
  echo "Class: $_SUPERCLASS"
  echo "Methods:"
  get_fcn_list "$(receiver_path $_RECEIVER)" | sed 's/^/ /'
}

__Debuggable__ancestry() {
  local current_class super
  current_class="$_RECEIVER"
  echo "Inheritance chain for $_RECEIVER:"
  while [[ -n "$current_class" ]]; do
  echo " $current_class"
  if [[ -f "$TRASHDIR/$current_class" ]]; then
  super=$(grep "^is_a" "$TRASHDIR/$current_class" | awk '{print $2}')
  current_class="$super"
  if [[ "$current_class" == "Object" ]]; then
  echo " Object"
  break
  fi
  else
  break
  fi
  done
}
