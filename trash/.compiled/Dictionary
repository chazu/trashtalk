#!/usr/bin/env bash
# Generated by Trashtalk Compiler (jq) - DO NOT EDIT
# Source: Dictionary.trash
# Generated: 2026-01-11T01:32:10

__Dictionary__superclass="Object"
__Dictionary__instanceVars="items:{}"
__Dictionary__classInstanceVars=""
__Dictionary__traits="Debuggable"
__Dictionary__sourceHash=""

__Dictionary__items() {
  echo "$(_ivar items)"; return
}

__Dictionary__items_() {
  _ivar_set items "$1"
}

__Dictionary__getItems() {
  echo "$(_ivar items)"; return
}

__Dictionary__setItems_() {
  _ivar_set items "$1"
}

__Dictionary__class__new() {
    local dict_id
    dict_id=$(@ Runtime generateId: "Dictionary")
    @ Runtime create: "Dictionary" id: "$dict_id"
    echo "$dict_id"
}

__Dictionary__getItems() {
  echo "$(_ivar items)"; return
}

__Dictionary__setItems_() {
  local newItems="$1"
  _ivar_set items "$newItems"
}

__Dictionary___getItemsObject() {
  echo "$(_ivar items)"; return
}

__Dictionary__at_() {
  local key="$1"
  echo "$(echo "$(_ivar items)" | jq -r --arg k "$key" '.[$k] // empty')"; return
}

__Dictionary__at_put_() {
  local key="$1"
  local value="$2"
  _ivar_set items "$(echo "$(_ivar items)" | jq -c --arg k "$key" --arg v "$value" '.[$k] = $v')"
  echo "$value"; return
}

__Dictionary__includesKey_() {
  local key="$1"
  echo "$(echo "$(_ivar items)" | jq --arg k "$key" 'has($k)')"; return
}

__Dictionary__removeAt_() {
  local key="$1"
  local oldValue
  oldValue="$(echo "$(_ivar items)" | jq -r --arg k "$key" '.[$k] // empty')"
  _ivar_set items "$(echo "$(_ivar items)" | jq -c --arg k "$key" 'del(.[$k])')"
  echo "$oldValue"; return
}

__Dictionary__keys() {
  echo "$(echo "$(_ivar items)" | jq -c 'keys')"; return
}

__Dictionary__values() {
  echo "$(echo "$(_ivar items)" | jq -c '[.[]]')"; return
}

__Dictionary__size() {
  echo "$(echo "$(_ivar items)" | jq 'length')"; return
}

__Dictionary__isEmpty() {
  echo "$(echo "$(_ivar items)" | jq 'length == 0')"; return
}

__Dictionary__show() {
  if [[ "$(echo "$(_ivar items)" | jq 'length == 0')" == "true" ]]; then echo "(empty dictionary)"; return; else echo "$(_ivar items)"; return; fi
}

__Dictionary__withPairs_() {
  local pairs="$1"
    local pairs="$1"
    local items pair key value
    items="{}"
    for pair in $pairs; do
        key="${pair%%:*}"
        value="${pair#*:}"
        items=$(echo "$items" | jq -c --arg k "$key" --arg v "$value" '.[$k] = $v')
    done
    _ivar_set items "$items"
    echo "$_RECEIVER"
}

__Dictionary__do_() {
  local block="$1"
    local items keys_json key value block_id="$1"
    items="$(_ivar items)"

    # Iterate over keys
    while IFS= read -r key; do
        value=$(echo "$items" | jq -r --arg k "$key" '.[$k]')
        @ "$block_id" valueWith_and "$key" "$value"
    done < <(echo "$items" | jq -r 'keys[]')
}

__Dictionary__keysDo_() {
  local block="$1"
    local items key block_id="$1"
    items="$(_ivar items)"

    while IFS= read -r key; do
        @ "$block_id" valueWith "$key"
    done < <(echo "$items" | jq -r 'keys[]')
}

__Dictionary__valuesDo_() {
  local block="$1"
    local items value block_id="$1"
    items="$(_ivar items)"

    while IFS= read -r value; do
        @ "$block_id" valueWith "$value"
    done < <(echo "$items" | jq -r '.[]')
}

__Dictionary__collect_() {
  local block="$1"
    local items key value result new_items block_id="$1"
    items="$(_ivar items)"
    new_items="{}"

    while IFS= read -r key; do
        value=$(echo "$items" | jq -r --arg k "$key" '.[$k]')
        result=$(@ "$block_id" valueWith "$value")
        new_items=$(echo "$new_items" | jq -c --arg k "$key" --arg v "$result" '.[$k] = $v')
    done < <(echo "$items" | jq -r 'keys[]')

        # Create new Dictionary with results
        local new_dict
        new_dict=$(@ Dictionary new)
        @ "$new_dict" setItems: "$new_items"
        echo "$new_dict"
}

__Dictionary__select_() {
  local block="$1"
    local items key value result new_items block_id="$1"
    items="$(_ivar items)"
    new_items="{}"

    while IFS= read -r key; do
        value=$(echo "$items" | jq -r --arg k "$key" '.[$k]')
        result=$(@ "$block_id" valueWith_and "$key" "$value")
        # Non-empty result means true
        if [[ -n "$result" ]]; then
            new_items=$(echo "$new_items" | jq -c --arg k "$key" --arg v "$value" '.[$k] = $v')
        fi
    done < <(echo "$items" | jq -r 'keys[]')

        # Create new Dictionary with selected pairs
        local new_dict
        new_dict=$(@ Dictionary new)
        @ "$new_dict" setItems: "$new_items"
        echo "$new_dict"
}

__Dictionary__merge_() {
  local other="$1"
    local other="$1"
    local items other_items merged
    items=$(_ivar items)
    other_items=$(@ "$other" asJson)
    merged=$(echo "$items" "$other_items" | jq -sc '.[0] * .[1]')
    _ivar_set items "$merged"
    echo "$_RECEIVER"
}

__Dictionary__at_ifAbsent_() {
  local key="$1"
  local default="$2"
  if [[ "$(echo "$(_ivar items)" | jq --arg k "$key" 'has($k)')" == "true" ]]; then echo "$(echo "$(_ivar items)" | jq -r --arg k "$key" '.[$k] // empty')"; return; else echo "$default"; return; fi
}

__Dictionary__clear() {
  @ "$_RECEIVER" setItems: '{}'
  echo ""$_RECEIVER""; return
}

__Dictionary__asJson() {
  echo "$(_ivar items)"; return
}

__Dictionary__class__fromJson_() {
  local json="$1"
  local dict
  dict="$(@ Dictionary new)"
  @ "$dict" setItems: "$json"
  echo "$dict"; return
}
