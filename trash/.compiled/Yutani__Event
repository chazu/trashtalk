#!/usr/bin/env bash
# Generated by Trashtalk Compiler (jq) - DO NOT EDIT
# Source: Event.trash
# Generated: 2026-01-07T18:45:54

__Yutani__Event__superclass="Object"
__Yutani__Event__instanceVars="rawJson:{} eventType: widgetId: keyName: keyMods: mouseX: mouseY: mouseButton: data:"
__Yutani__Event__classInstanceVars=""
__Yutani__Event__traits=""
__Yutani__Event__sourceHash="407377fb158205da1a860e2ba4c38b7c7743be0376e25dd7224c4615ce87c199"
__Yutani__Event__package="Yutani"
__Yutani__Event__qualifiedName="Yutani::Event"

__Yutani__Event__source() {
  cat <<'__TRASHTALK_SOURCE_EOF__'
package: Yutani

Event subclass: Object
  instanceVars: rawJson:'{}' eventType:'' widgetId:'' keyName:'' keyMods:'' mouseX:'' mouseY:'' mouseButton:'' data:''

  # Parse a JSON event string into an Event object
  # This remains a rawClassMethod due to complex conditional logic
  rawClassMethod: fromJson: json [
    local json="$1"
    local instance keyData widgetData mouseData

    instance=$(_generate_instance_id "Yutani__Event")
    _create_instance "Yutani::Event" "$instance"

    # Store raw JSON as object
    @ "$instance" _setRawJson: "$json"

    # Determine event type by checking which key exists
    if [[ $(echo "$json" | jq -c '.key // empty') != "" ]]; then
      @ "$instance" _setEventType: "key"
      @ "$instance" _setKeyName: "$(echo "$json" | jq -r '.key.key // ""')"
      @ "$instance" _setKeyMods: "$(echo "$json" | jq -r '.key.modifiers // ""')"
    elif [[ $(echo "$json" | jq -c '.widget // empty') != "" ]]; then
      @ "$instance" _setEventType: "widget"
      @ "$instance" _setWidgetId: "$(echo "$json" | jq -r '.widget.widgetId.id // ""')"
      @ "$instance" _setData: "$(echo "$json" | jq -r '.widget.type // ""')"
    elif [[ $(echo "$json" | jq -c '.mouse // empty') != "" ]]; then
      @ "$instance" _setEventType: "mouse"
      @ "$instance" _setMouseX: "$(echo "$json" | jq -r '.mouse.x // 0')"
      @ "$instance" _setMouseY: "$(echo "$json" | jq -r '.mouse.y // 0')"
      @ "$instance" _setMouseButton: "$(echo "$json" | jq -r '.mouse.button // ""')"
    elif [[ $(echo "$json" | jq -c '.resize // empty') != "" ]]; then
      @ "$instance" _setEventType: "resize"
    elif [[ $(echo "$json" | jq -c '.focus // empty') != "" ]]; then
      @ "$instance" _setEventType: "focus"
    else
      @ "$instance" _setEventType: "unknown"
    fi

    echo "$instance"
  ]

  # Type checking methods - now regular methods using string comparison
  method: isKeyEvent [
    ^ eventType = 'key'
  ]

  method: isWidgetEvent [
    ^ eventType = 'widget'
  ]

  method: isMouseEvent [
    ^ eventType = 'mouse'
  ]

  method: isResizeEvent [
    ^ eventType = 'resize'
  ]

  method: isFocusEvent [
    ^ eventType = 'focus'
  ]

  # Accessors - these compile directly
  method: getEventType [
    ^ eventType
  ]

  method: getWidgetId [
    ^ widgetId
  ]

  method: getKeyName [
    ^ keyName
  ]

  method: getKeyMods [
    ^ keyMods
  ]

  method: getMouseX [
    ^ mouseX
  ]

  method: getMouseY [
    ^ mouseY
  ]

  method: getMouseButton [
    ^ mouseButton
  ]

  method: getData [
    ^ data
  ]

  method: getRawJson [
    ^ rawJson
  ]

  # Get widget event type using JSON primitives
  method: widgetEventType [
    | widget |
    widget := rawJson objectAt: 'widget'.
    ^ widget objectAt: 'type'
  ]

  # Get widget event data object using JSON primitives
  method: widgetData [
    | widget |
    widget := rawJson objectAt: 'widget'.
    ^ widget objectAt: 'data'
  ]

  # Get specific widget data field using JSON primitives
  method: widgetDataAt: key [
    | widget widgetDataObj |
    widget := rawJson objectAt: 'widget'.
    widgetDataObj := widget objectAt: 'data'.
    ^ widgetDataObj objectAt: key
  ]

  # Check if this is a specific key - using string comparison
  method: isKey: keyToCheck [
    ^ keyName = keyToCheck
  ]

  # Check for common keys
  method: isEnterKey [
    ^ keyName = 'KEY_ENTER'
  ]

  method: isEscapeKey [
    ^ keyName = 'KEY_ESC'
  ]

  method: isTabKey [
    ^ keyName = 'KEY_TAB'
  ]

  method: isCtrlC [
    ^ keyName = 'KEY_CTRL_C'
  ]

  method: isCtrlD [
    ^ keyName = 'KEY_CTRL_D'
  ]

  method: isCtrlL [
    ^ keyName = 'KEY_CTRL_L'
  ]

  # Check if widget event is submission (WIDGET_DONE from Yutani)
  method: isSubmission [
    | wt |
    wt := @ self widgetEventType.
    ^ wt = 'WIDGET_DONE'
  ]

  # Private setters
  method: _setRawJson: v [ rawJson := v ]
  method: _setEventType: v [ eventType := v ]
  method: _setWidgetId: v [ widgetId := v ]
  method: _setKeyName: v [ keyName := v ]
  method: _setKeyMods: v [ keyMods := v ]
  method: _setMouseX: v [ mouseX := v ]
  method: _setMouseY: v [ mouseY := v ]
  method: _setMouseButton: v [ mouseButton := v ]
  method: _setData: v [ data := v ]
__TRASHTALK_SOURCE_EOF__
}

__Yutani__Event__rawJson() {
  echo "$(_ivar rawJson)"; return
}

__Yutani__Event__rawJson_() {
  _ivar_set rawJson "$1"
}

__Yutani__Event__getRawJson() {
  echo "$(_ivar rawJson)"; return
}

__Yutani__Event__setRawJson_() {
  _ivar_set rawJson "$1"
}
__Yutani__Event__eventType() {
  echo "$(_ivar eventType)"; return
}

__Yutani__Event__eventType_() {
  _ivar_set eventType "$1"
}

__Yutani__Event__getEventType() {
  echo "$(_ivar eventType)"; return
}

__Yutani__Event__setEventType_() {
  _ivar_set eventType "$1"
}
__Yutani__Event__widgetId() {
  echo "$(_ivar widgetId)"; return
}

__Yutani__Event__widgetId_() {
  _ivar_set widgetId "$1"
}

__Yutani__Event__getWidgetId() {
  echo "$(_ivar widgetId)"; return
}

__Yutani__Event__setWidgetId_() {
  _ivar_set widgetId "$1"
}
__Yutani__Event__keyName() {
  echo "$(_ivar keyName)"; return
}

__Yutani__Event__keyName_() {
  _ivar_set keyName "$1"
}

__Yutani__Event__getKeyName() {
  echo "$(_ivar keyName)"; return
}

__Yutani__Event__setKeyName_() {
  _ivar_set keyName "$1"
}
__Yutani__Event__keyMods() {
  echo "$(_ivar keyMods)"; return
}

__Yutani__Event__keyMods_() {
  _ivar_set keyMods "$1"
}

__Yutani__Event__getKeyMods() {
  echo "$(_ivar keyMods)"; return
}

__Yutani__Event__setKeyMods_() {
  _ivar_set keyMods "$1"
}
__Yutani__Event__mouseX() {
  echo "$(_ivar mouseX)"; return
}

__Yutani__Event__mouseX_() {
  _ivar_set mouseX "$1"
}

__Yutani__Event__getMouseX() {
  echo "$(_ivar mouseX)"; return
}

__Yutani__Event__setMouseX_() {
  _ivar_set mouseX "$1"
}
__Yutani__Event__mouseY() {
  echo "$(_ivar mouseY)"; return
}

__Yutani__Event__mouseY_() {
  _ivar_set mouseY "$1"
}

__Yutani__Event__getMouseY() {
  echo "$(_ivar mouseY)"; return
}

__Yutani__Event__setMouseY_() {
  _ivar_set mouseY "$1"
}
__Yutani__Event__mouseButton() {
  echo "$(_ivar mouseButton)"; return
}

__Yutani__Event__mouseButton_() {
  _ivar_set mouseButton "$1"
}

__Yutani__Event__getMouseButton() {
  echo "$(_ivar mouseButton)"; return
}

__Yutani__Event__setMouseButton_() {
  _ivar_set mouseButton "$1"
}
__Yutani__Event__data() {
  echo "$(_ivar data)"; return
}

__Yutani__Event__data_() {
  _ivar_set data "$1"
}

__Yutani__Event__getData() {
  echo "$(_ivar data)"; return
}

__Yutani__Event__setData_() {
  _ivar_set data "$1"
}

__Yutani__Event__class__fromJson_() {
  local json="$1"
    local json="$1"
    local instance keyData widgetData mouseData

    instance=$(_generate_instance_id "Yutani__Event")
    _create_instance "Yutani::Event" "$instance"

    # Store raw JSON as object
    @ "$instance" _setRawJson: "$json"

    # Determine event type by checking which key exists
    if [[ $(echo "$json" | jq -c '.key // empty') != "" ]]; then
        @ "$instance" _setEventType: "key"
        @ "$instance" _setKeyName: "$(echo "$json" | jq -r '.key.key // ""')"
        @ "$instance" _setKeyMods: "$(echo "$json" | jq -r '.key.modifiers // ""')"
        elif [[ $(echo "$json" | jq -c '.widget // empty') != "" ]]; then
            @ "$instance" _setEventType: "widget"
            @ "$instance" _setWidgetId: "$(echo "$json" | jq -r '.widget.widgetId.id // ""')"
            @ "$instance" _setData: "$(echo "$json" | jq -r '.widget.type // ""')"
            elif [[ $(echo "$json" | jq -c '.mouse // empty') != "" ]]; then
                @ "$instance" _setEventType: "mouse"
                @ "$instance" _setMouseX: "$(echo "$json" | jq -r '.mouse.x // 0')"
                @ "$instance" _setMouseY: "$(echo "$json" | jq -r '.mouse.y // 0')"
                @ "$instance" _setMouseButton: "$(echo "$json" | jq -r '.mouse.button // ""')"
                elif [[ $(echo "$json" | jq -c '.resize // empty') != "" ]]; then
                    @ "$instance" _setEventType: "resize"
                    elif [[ $(echo "$json" | jq -c '.focus // empty') != "" ]]; then
                        @ "$instance" _setEventType: "focus"
                        else
                        @ "$instance" _setEventType: "unknown"
                    fi

                    echo "$instance"
}

__Yutani__Event__isKeyEvent() {
  echo eventType ='key'
}

__Yutani__Event__isWidgetEvent() {
  echo eventType ='widget'
}

__Yutani__Event__isMouseEvent() {
  echo eventType ='mouse'
}

__Yutani__Event__isResizeEvent() {
  echo eventType ='resize'
}

__Yutani__Event__isFocusEvent() {
  echo eventType ='focus'
}

__Yutani__Event__getEventType() {
  echo "$(_ivar eventType)"; return
}

__Yutani__Event__getWidgetId() {
  echo "$(_ivar widgetId)"; return
}

__Yutani__Event__getKeyName() {
  echo "$(_ivar keyName)"; return
}

__Yutani__Event__getKeyMods() {
  echo "$(_ivar keyMods)"; return
}

__Yutani__Event__getMouseX() {
  echo "$(_ivar mouseX)"; return
}

__Yutani__Event__getMouseY() {
  echo "$(_ivar mouseY)"; return
}

__Yutani__Event__getMouseButton() {
  echo "$(_ivar mouseButton)"; return
}

__Yutani__Event__getData() {
  echo "$(_ivar data)"; return
}

__Yutani__Event__getRawJson() {
  echo "$(_ivar rawJson)"; return
}

__Yutani__Event__widgetEventType() {
  local widget
  widget="$(echo "$(_ivar rawJson)" | jq -r --arg k "widget" '.[$k] // empty')"
  echo "$(echo "$widget" | jq -r --arg k "type" '.[$k] // empty')"; return
}

__Yutani__Event__widgetData() {
  local widget
  widget="$(echo "$(_ivar rawJson)" | jq -r --arg k "widget" '.[$k] // empty')"
  echo "$(echo "$widget" | jq -r --arg k "data" '.[$k] // empty')"; return
}

__Yutani__Event__widgetDataAt_() {
  local key="$1"
  local widget widgetDataObj
  widget="$(echo "$(_ivar rawJson)" | jq -r --arg k "widget" '.[$k] // empty')"
  widgetDataObj="$(echo "$widget" | jq -r --arg k "data" '.[$k] // empty')"
  echo "$(echo "$widgetDataObj" | jq -r --arg k "$key" '.[$k] // empty')"; return
}

__Yutani__Event__isKey_() {
  local keyToCheck="$1"
  echo keyName=keyToCheck
}

__Yutani__Event__isEnterKey() {
  echo keyName ='KEY_ENTER'
}

__Yutani__Event__isEscapeKey() {
  echo keyName ='KEY_ESC'
}

__Yutani__Event__isTabKey() {
  echo keyName ='KEY_TAB'
}

__Yutani__Event__isCtrlC() {
  echo keyName ='KEY_CTRL_C'
}

__Yutani__Event__isCtrlD() {
  echo keyName ='KEY_CTRL_D'
}

__Yutani__Event__isCtrlL() {
  echo keyName ='KEY_CTRL_L'
}

__Yutani__Event__isSubmission() {
  local wt
  wt="$(@ "$_RECEIVER" widgetEventType)"
  echo "$(( $wt = 0 ))"; return
}

__Yutani__Event___setRawJson_() {
  local v="$1"
  _ivar_set rawJson "$v"
}

__Yutani__Event___setEventType_() {
  local v="$1"
  _ivar_set eventType "$v"
}

__Yutani__Event___setWidgetId_() {
  local v="$1"
  _ivar_set widgetId "$v"
}

__Yutani__Event___setKeyName_() {
  local v="$1"
  _ivar_set keyName "$v"
}

__Yutani__Event___setKeyMods_() {
  local v="$1"
  _ivar_set keyMods "$v"
}

__Yutani__Event___setMouseX_() {
  local v="$1"
  _ivar_set mouseX "$v"
}

__Yutani__Event___setMouseY_() {
  local v="$1"
  _ivar_set mouseY "$v"
}

__Yutani__Event___setMouseButton_() {
  local v="$1"
  _ivar_set mouseButton "$v"
}

__Yutani__Event___setData_() {
  local v="$1"
  _ivar_set data "$v"
}
