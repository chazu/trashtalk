#!/usr/bin/env bash
# Generated by Trashtalk Compiler (jq) - DO NOT EDIT
# Source: Env.trash
# Generated: 2026-01-12T14:53:36

__Env__superclass="Object"
__Env__instanceVars=""
__Env__classInstanceVars=""
__Env__traits=""
__Env__sourceHash="a0bf19e39ebaae1632dc2c660c3c4a0994365d4599aaa28a175f12ce829e96f9"
__Env__primitiveClass="1"

__Env__source() {
  cat <<'__TRASHTALK_SOURCE_EOF__'
# Env - Environment variable primitive class
# Provides access to environment variables and system paths
#
# Usage:
#   home := @ Env get: 'HOME'
#   editor := @ Env get: 'EDITOR' default: 'vi'
#   @ Env set: 'MY_VAR' to: 'value'
#
Env subclass: Object
  pragma: primitiveClass

  # ==========================================
  # Variable Access
  # ==========================================

  # Get an environment variable (empty string if not set)
  # Usage: home := @ Env get: 'HOME'
  primitiveClassMethod: get: name [
    echo "${!1:-}"
  ]

  # Get an environment variable with default value
  # Usage: editor := @ Env get: 'EDITOR' default: 'vi'
  primitiveClassMethod: get: name default: defaultValue [
    local value="${!1:-}"
    if [[ -n "$value" ]]; then
      echo "$value"
    else
      echo "$2"
    fi
  ]

  # Set an environment variable
  # Usage: @ Env set: 'MY_VAR' to: 'value'
  # Note: rawClassMethod because export must run in parent shell
  rawClassMethod: set: name to: value [
    pragma: direct
    export "$1=$2"
  ]

  # Unset an environment variable
  # Usage: @ Env unset: 'MY_VAR'
  # Note: rawClassMethod because unset must run in parent shell
  rawClassMethod: unset: name [
    pragma: direct
    unset "$1"
  ]

  # Check if an environment variable is set (even if empty)
  # Usage: exists := @ Env has: 'HOME'
  primitiveClassMethod: has: name [
    if [[ -v "$1" ]]; then
      echo "true"
    else
      echo "false"
    fi
  ]

  # Check if an environment variable is set and non-empty
  # Usage: exists := @ Env hasNonEmpty: 'HOME'
  primitiveClassMethod: hasNonEmpty: name [
    local value="${!1:-}"
    if [[ -n "$value" ]]; then
      echo "true"
    else
      echo "false"
    fi
  ]

  # ==========================================
  # Path Operations
  # ==========================================

  # Find an executable in PATH
  # Usage: path := @ Env which: 'curl'
  primitiveClassMethod: which: executable [
    which "$1" 2>/dev/null || echo ""
  ]

  # Check if an executable exists in PATH
  # Usage: exists := @ Env hasExecutable: 'curl'
  primitiveClassMethod: hasExecutable: executable [
    if which "$1" >/dev/null 2>&1; then
      echo "true"
    else
      echo "false"
    fi
  ]

  # Get the PATH as a JSON array
  # Usage: paths := @ Env pathComponents
  rawClassMethod: pathComponents [
    local paths="[]"
    local IFS=':'
    for p in $PATH; do
      paths=$(echo "$paths" | jq -c --arg p "$p" '. + [$p]')
    done
    echo "$paths"
  ]

  # Add a directory to PATH (prepend)
  # Usage: @ Env addToPath: '/usr/local/bin'
  rawClassMethod: addToPath: directory [
    export PATH="$1:$PATH"
  ]

  # Add a directory to end of PATH (append)
  # Usage: @ Env appendToPath: '/opt/bin'
  rawClassMethod: appendToPath: directory [
    export PATH="$PATH:$1"
  ]

  # ==========================================
  # Common Variables
  # ==========================================

  # Get home directory
  primitiveClassMethod: home [
    echo "$HOME"
  ]

  # Get current user
  primitiveClassMethod: user [
    echo "${USER:-$(whoami)}"
  ]

  # Get shell
  primitiveClassMethod: shell [
    echo "$SHELL"
  ]

  # Get current working directory
  primitiveClassMethod: cwd [
    pwd
  ]

  # Get temp directory
  primitiveClassMethod: temp [
    echo "${TMPDIR:-/tmp}"
  ]

  # Get editor
  primitiveClassMethod: editor [
    echo "${EDITOR:-${VISUAL:-vi}}"
  ]

  # Get hostname
  primitiveClassMethod: hostname [
    hostname
  ]

  # Get OS type
  primitiveClassMethod: os [
    echo "$OSTYPE"
  ]

  # Check if running on macOS
  primitiveClassMethod: isMac [
    if [[ "$OSTYPE" == "darwin"* ]]; then
      echo "true"
    else
      echo "false"
    fi
  ]

  # Check if running on Linux
  primitiveClassMethod: isLinux [
    if [[ "$OSTYPE" == "linux"* ]]; then
      echo "true"
    else
      echo "false"
    fi
  ]

  # ==========================================
  # Bulk Operations
  # ==========================================

  # Get all environment variables as JSON object
  # Usage: vars := @ Env all
  rawClassMethod: all [
    env | jq -Rs 'split("\n") | map(select(length > 0)) | map(split("=") | {(.[0]): .[1:] | join("=")}) | add'
  ]

  # Get environment variables matching a prefix as JSON object
  # Usage: vars := @ Env allWithPrefix: 'MY_APP_'
  rawClassMethod: allWithPrefix: prefix [
    env | grep "^$1" | jq -Rs 'split("\n") | map(select(length > 0)) | map(split("=") | {(.[0]): .[1:] | join("=")}) | add // {}'
  ]
__TRASHTALK_SOURCE_EOF__
}

__Env__class__get_() {
  local name="$1"
    echo "${!1:-}"
}

__Env__class__get_default_() {
  local name="$1"
  local defaultValue="$2"
    local value="${!1:-}"
    if [[ -n "$value" ]]; then
        echo "$value"
        else
        echo "$2"
    fi
}

declare -g __Env__class__set_to___direct=1
__Env__class__set_to_() {
  local name="$1"
  local value="$2"
    export "$1=$2"
}

declare -g __Env__class__unset___direct=1
__Env__class__unset_() {
  local name="$1"
    unset "$1"
}

__Env__class__has_() {
  local name="$1"
    if [[ -v "$1" ]]; then
        echo "true"
        else
        echo "false"
    fi
}

__Env__class__hasNonEmpty_() {
  local name="$1"
    local value="${!1:-}"
    if [[ -n "$value" ]]; then
        echo "true"
        else
        echo "false"
    fi
}

__Env__class__which_() {
  local executable="$1"
    which "$1" 2>/dev/null || echo ""
}

__Env__class__hasExecutable_() {
  local executable="$1"
    if which "$1" >/dev/null 2>&1; then
        echo "true"
        else
        echo "false"
    fi
}

__Env__class__pathComponents() {
    local paths="[]"
    local IFS=':'
    for p in $PATH; do
        paths=$(echo "$paths" | jq -c --arg p "$p" '. + [$p]')
    done
    echo "$paths"
}

__Env__class__addToPath_() {
  local directory="$1"
    export PATH="$1:$PATH"
}

__Env__class__appendToPath_() {
  local directory="$1"
    export PATH="$PATH:$1"
}

__Env__class__home() {
    echo "$HOME"
}

__Env__class__user() {
    echo "${USER:-$(whoami)}"
}

__Env__class__shell() {
    echo "$SHELL"
}

__Env__class__cwd() {
    pwd
}

__Env__class__temp() {
    echo "${TMPDIR:-/tmp}"
}

__Env__class__editor() {
    echo "${EDITOR:-${VISUAL:-vi}}"
}

__Env__class__hostname() {
    hostname
}

__Env__class__os() {
    echo "$OSTYPE"
}

__Env__class__isMac() {
    if [[ "$OSTYPE" == "darwin"* ]]; then
        echo "true"
        else
        echo "false"
    fi
}

__Env__class__isLinux() {
    if [[ "$OSTYPE" == "linux"* ]]; then
        echo "true"
        else
        echo "false"
    fi
}

__Env__class__all() {
    env | jq -Rs 'split("\n") | map(select(length > 0)) | map(split("=") | {(.[0]): .[1:] | join("=")}) | add'
}

__Env__class__allWithPrefix_() {
  local prefix="$1"
    env | grep "^$1" | jq -Rs 'split("\n") | map(select(length > 0)) | map(split("=") | {(.[0]): .[1:] | join("=")}) | add // {}'
}
